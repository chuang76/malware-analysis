rule wannacry
{
	meta:
		description = "Yara rule to detect wannacry ransomware"
		
	strings:
		$bitcoin_addr1 = "115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn"
		$bitcoin_addr2 = "12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw"
		$bitcoin_addr3 = "13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94"
		$s1 = "http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com"
		$s2 = "C:\\%s\\qeriuwjhrf"
		$s3 = "Microsoft Security Center (2.0) Service"
		$s4 = "WanaCrypt0r"
		$s5 = "WNcry@2ol7"
		$s6 = "WANACRY!"
		$s7 = "tasksche.exe"
		$s8 = "taskdl.exe"
		$s9 = "taskse.exe"
		$s10 = "TaskStart"
	
	condition:
		($bitcoin_addr1 or $bitcoin_addr2 or $bitcoin_addr3) and (8 of ($s*))
}